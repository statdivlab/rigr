<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rigr">
<title>One- and two-sample inference in rigr • rigr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="One- and two-sample inference in rigr">
<meta property="og:description" content="rigr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rigr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/descrip_intro.html">Descriptive statistics in rigr</a>
    <a class="dropdown-item" href="../articles/one_and_two_sample_inference.html">One- and two-sample inference in rigr</a>
    <a class="dropdown-item" href="../articles/regress_intro.html">Regression in rigr</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/statdivlab/rigr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>One- and two-sample inference in rigr</h1>
                        <h4 data-toc-skip class="author">Charles Wolock,
Brian D. Williamson, and Scott S. Emerson</h4>
            
            <h4 data-toc-skip class="date">2024-03-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/statdivlab/rigr/blob/HEAD/vignettes/one_and_two_sample_inference.Rmd" class="external-link"><code>vignettes/one_and_two_sample_inference.Rmd</code></a></small>
      <div class="d-none name"><code>one_and_two_sample_inference.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statdivlab.github.io/rigr/">rigr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rigr version 1.0.6: Regression, Inference, and General Data Analysis Tools in R</span></span></code></pre>
<p>The <code>rigr</code> package replicates many of the basic
inferential functions from R’s <code>stats</code> package, with an eye
toward inference as taught in an introductory statistics class. To
demonstrate these basic functions, we will use the included
<code>mri</code> dataset. Information about the dataset can be found by
running <code><a href="../reference/mri.html">?mri</a></code>. Since the data is part of the package, we can
load it via</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<p>Throughout this vignette, we will assume familiarity with basic data
manipulation and statistical tasks.</p>
<div class="section level2">
<h2 id="one-and-two-sample-inference">One and two-sample inference<a class="anchor" aria-label="anchor" href="#one-and-two-sample-inference"></a>
</h2>
<p>Many of our analyses boil down to one-sample or two-sample problems,
such as “What is the mean time to graduation?”, “What is the median home
price in Seattle?”, or “What is the difference in mean time to a relapse
event between the control and the treatment group?” There are many
methods of analyzing one- and two-sample relationships, and in our
package we have implemented three common approaches.</p>
<div class="section level3">
<h3 id="t-tests">t-tests<a class="anchor" aria-label="anchor" href="#t-tests"></a>
</h3>
<p>We are often interested in making statements about the average (or
<em>mean</em>) value of a variable. A one-sample t-test asks whether the
mean of the distribution from which a sample is drawn is equal to some
fixed value. A two-sample t-test asks whether the difference in means
between two distributions is equal to some value (often zero, i.e., no
difference in means).</p>
<p>Our function <code><a href="../reference/ttest.html">ttest()</a></code> is flexible, allowing
stratification, calculation of the geometric mean, and equal/unequal
variances between samples. For example, a t-test of whether the mean of
the <code>ldl</code> variable is equal to 125 mg/dL can be performed
using <code>rigr</code> as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ttest.html">ttest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span>, null.hypoth <span class="op">=</span> <span class="fl">125</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ttest(var1 = mri$ldl, null.hypoth = 125)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## One-sample t-test :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">##  Variable Obs Missing Mean Std. Err. Std. Dev.     95% CI</span></span>
<span><span class="co">##   mri$ldl 735      10  126      1.25      33.6 [123, 128]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho:  mean = 125 ; </span></span>
<span><span class="co">##  Ha:  mean != 125 </span></span>
<span><span class="co">##  t = 0.6433 , df = 724 </span></span>
<span><span class="co">##  Pr(|T| &gt; t) =  0.520256</span></span></code></pre>
<p>Note that in addition to running the hypothesis test,
<code>ttest</code> also returns a point estimate (the column
<code>Mean</code> under <code>Summary</code>) and a 95% confidence
interval for the true mean LDL.</p>
<p>If instead we wanted a two-sample t-test of whether the difference in
mean LDL between males and females were zero, we could stratify using
the <code>by</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ttest.html">ttest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span>, by <span class="op">=</span> <span class="va">mri</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ttest(var1 = mri$ldl, by = mri$sex)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Two-sample t-test allowing for unequal variances :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">##               Group Obs Missing  Mean Std. Err. Std. Dev.         95% CI</span></span>
<span><span class="co">##    mri$sex = Female 369       4 130.9      1.79      34.3 [127.4, 134.5]</span></span>
<span><span class="co">##      mri$sex = Male 366       6 120.6      1.69      32.1 [117.3, 123.9]</span></span>
<span><span class="co">##          Difference 735      10  10.3      2.47      &lt;NA&gt;    [5.5, 15.2]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho: difference in  means = 0 ; </span></span>
<span><span class="co">##  Ha: difference in  means != 0 </span></span>
<span><span class="co">##  t = 4.194 , df = 721 </span></span>
<span><span class="co">##  Pr(|T| &gt; t) =  3.08428e-05</span></span></code></pre>
<p>In addition to using <code>by</code>, we can also run two-sample
tests by simply providing two data vectors:
<code>ttest(mri$ldl[mri$sex == "Female"], mri$ldl[mri$sex == "Male"])</code>.</p>
<p>Note that the default of <code>ttest</code> is to assume unequal
variances between groups, which we (the authors of this package) believe
to be the best choice in most scenarios. We also run two-sided tests by
default, but others can be specified, along with non-zero null
hypotheses, and tests at levels other than 0.95:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ttest.html">ttest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span>, null.hypoth <span class="op">=</span> <span class="fl">125</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ttest(var1 = mri$ldl, null.hypoth = 125, conf.level = 0.9)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## One-sample t-test :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">##  Variable Obs Missing Mean Std. Err. Std. Dev.     90% CI</span></span>
<span><span class="co">##   mri$ldl 735      10  126      1.25      33.6 [124, 128]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho:  mean = 125 ; </span></span>
<span><span class="co">##  Ha:  mean != 125 </span></span>
<span><span class="co">##  t = 0.6433 , df = 724 </span></span>
<span><span class="co">##  Pr(|T| &gt; t) =  0.520256</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ttest.html">ttest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span>, by <span class="op">=</span> <span class="va">mri</span><span class="op">$</span><span class="va">sex</span>, var.eq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ttest(var1 = mri$ldl, by = mri$sex, var.eq = FALSE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Two-sample t-test allowing for unequal variances :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">##               Group Obs Missing  Mean Std. Err. Std. Dev.         95% CI</span></span>
<span><span class="co">##    mri$sex = Female 369       4 130.9      1.79      34.3 [127.4, 134.5]</span></span>
<span><span class="co">##      mri$sex = Male 366       6 120.6      1.69      32.1 [117.3, 123.9]</span></span>
<span><span class="co">##          Difference 735      10  10.3      2.47      &lt;NA&gt;    [5.5, 15.2]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho: difference in  means = 0 ; </span></span>
<span><span class="co">##  Ha: difference in  means != 0 </span></span>
<span><span class="co">##  t = 4.194 , df = 721 </span></span>
<span><span class="co">##  Pr(|T| &gt; t) =  3.08428e-05</span></span></code></pre>
<p>If we prefer to run the test using summary statistics (sample mean,
sample standard deviation, and sample size) we can instead use the
<code>ttesti</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ttesti.html">ttesti</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>, null.hypoth <span class="op">=</span> <span class="fl">155</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## ttesti(obs = length(mri$weight), mean = mean(mri$weight), sd = sd(mri$weight), </span></span>
<span><span class="co">##     null.hypoth = 155)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## One-sample t-test :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">##      Obs Mean Std. Error Std. Dev. 95% CI    </span></span>
<span><span class="co">## var1 735 160  1.13       30.7      [158, 162]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho:  mean = 155 ; </span></span>
<span><span class="co">##  Ha:  mean != 155 </span></span>
<span><span class="co">##  t = 4.365 , df = 734 </span></span>
<span><span class="co">##  Pr(|T| &gt; t) =  1.45125e-05</span></span></code></pre>
<p>The result is the same as that provided by
<code>ttest(mri$weight, null.hypoth = 155)</code>.</p>
</div>
<div class="section level3">
<h3 id="tests-of-proportions">Tests of proportions<a class="anchor" aria-label="anchor" href="#tests-of-proportions"></a>
</h3>
<p>In the above example, we investigated the mean of a continuous random
variable. However, sometimes we work with binary data. In this case, we
may wish to make inference on probabilities. In <code>rigr</code>, we
can do this using <code>proptest</code>. For one-sample proportion
tests, there are both approximate (based on the normal distribution) and
exact (based on the binomial distribution) options. For example, we may
wish to test whether the proportion of LDL values that are greater than
128mg/dL is equal to 0.5.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/proptest.html">proptest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span> <span class="op">&gt;</span> <span class="fl">128</span>, null.hypoth <span class="op">=</span> <span class="fl">0.5</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## proptest(var1 = mri$ldl &gt; 128, exact = FALSE, null.hypoth = 0.5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## One-sample proportion test (approximate) :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##       Variable Obs Missing  Estimate Std. Err.       95% CI</span></span>
<span><span class="co">##  mri$ldl &gt; 128 735      10 0.4634483    0.0185 [0.427, 0.5]</span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho: True proportion is = 0.5; </span></span>
<span><span class="co">##  Ha: True proportion is != 0.5 </span></span>
<span><span class="co">##  Z = -1.97 </span></span>
<span><span class="co">##  p-value = 0.049</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/proptest.html">proptest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span> <span class="op">&gt;</span> <span class="fl">128</span>, null.hypoth <span class="op">=</span> <span class="fl">0.5</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## proptest(var1 = mri$ldl &gt; 128, exact = TRUE, null.hypoth = 0.5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## One-sample proportion test (exact) :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##       Variable Obs Missing  Estimate Std. Err.         95% CI</span></span>
<span><span class="co">##  mri$ldl &gt; 128 735      10 0.4634483    0.0185 [0.427, 0.501]</span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho: True proportion is = 0.5; </span></span>
<span><span class="co">##  Ha: True proportion is != 0.5 </span></span>
<span><span class="co">##   </span></span>
<span><span class="co">##  p-value = 0.0534</span></span></code></pre>
<p>Note that we are creating our binary data within the
<code>proptest</code> call. The <code>proptest</code> function works
with 0-1 numeric data, two-level factors, or (as above)
<code>TRUE</code>/<code>FALSE</code> data. Using the <code>exact</code>
argument allows us to choose what kind of test we run. In this case, the
results are quite similar.</p>
<p>Given two samples, we can also test whether two proportions are equal
to each other. There is no <code>exact</code> option for a two-sample
test. Here we test whether the proportion of men with LDL greater than
128 mg/dL is the same as the proportion of women.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/proptest.html">proptest</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">ldl</span> <span class="op">&gt;</span> <span class="fl">128</span>, by <span class="op">=</span> <span class="va">mri</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## proptest(var1 = mri$ldl &gt; 128, by = mri$sex)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Two-sample proportion test (approximate) :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##               Group Obs Missing      Mean Std. Err.          95% CI</span></span>
<span><span class="co">##    mri$sex = Female 369       4 0.5287671    0.0261  [0.4776, 0.58]</span></span>
<span><span class="co">##      mri$sex = Male 366       6 0.3972222    0.0258 [0.3467, 0.448]</span></span>
<span><span class="co">##          Difference 735      10 0.1315449    0.0367 [0.0596, 0.203]</span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho: Difference in proportions = 0 </span></span>
<span><span class="co">##  Ha: Difference in proportions != 0 </span></span>
<span><span class="co">##  Z = 3.55 </span></span>
<span><span class="co">##  p.value = 0.000383</span></span></code></pre>
<p>The <code>proptesti</code> function is analogous to
<code>ttesti</code> described above - rather than providing data
vectors, we can provide summary statistics in the form of counts of
successes out of a total number of trials. Here we test whether the
proportion of people with weight greater than 155 lbs is equal to
0.6.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/proptesti.html">proptesti</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">weight</span> <span class="op">&gt;</span> <span class="fl">155</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mri</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>, exact <span class="op">=</span> <span class="cn">FALSE</span>, null.hypoth<span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## proptesti(x1 = sum(mri$weight &gt; 155), n1 = length(mri$weight), </span></span>
<span><span class="co">##     exact = FALSE, null.hypoth = 0.6)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## One-sample proportion test (approximate)  :</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Variable Obs Mean  Std. Error 95% CI        </span></span>
<span><span class="co">##  var1     735 0.533 0.0184     [0.497, 0.569]</span></span>
<span><span class="co">## Summary:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Ho: True proportion is = 0.6; </span></span>
<span><span class="co">##  Ha: True proportion is != 0.6 </span></span>
<span><span class="co">##  Z = -3.69 </span></span>
<span><span class="co">##  p.value = 0.000225</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="wilcoxon-and-mann-whitney">Wilcoxon and Mann-Whitney<a class="anchor" aria-label="anchor" href="#wilcoxon-and-mann-whitney"></a>
</h3>
<p>The Wilcoxon and Mann-Whitney tests, which use the “rank” of the
given variables, are nonparametric methods for analyzing the locations
of the underlying distributions that gave rise to a dataset. They are
often viewed as alternative to one- and two-sample t-tests,
respectively.</p>
<p>Our function <code><a href="../reference/wilcoxon.html">wilcoxon()</a></code> takes one or two samples and
performs either an approximate or exact test of location. Since these
tests are not based on the mean of the data, the output looks slightly
different from that of <code>ttest</code>. Here, we perform a paired
(matched) test on made-up data comparing individuals with cystic
fibrosis (CF) to health individuals.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create the data</span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1153</span>, <span class="fl">1132</span>, <span class="fl">1165</span>, <span class="fl">1460</span>, <span class="fl">1162</span>, <span class="fl">1493</span>, <span class="fl">1358</span>, <span class="fl">1453</span>, <span class="fl">1185</span>, <span class="fl">1824</span>, <span class="fl">1793</span>, <span class="fl">1930</span>, <span class="fl">2075</span><span class="op">)</span></span>
<span><span class="va">healthy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">996</span>, <span class="fl">1080</span>, <span class="fl">1182</span>, <span class="fl">1452</span>, <span class="fl">1634</span>, <span class="fl">1619</span>, <span class="fl">1140</span>, <span class="fl">1123</span>, <span class="fl">1113</span>, <span class="fl">1463</span>, <span class="fl">1632</span>, <span class="fl">1614</span>, <span class="fl">1836</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/wilcoxon.html">wilcoxon</a></span><span class="op">(</span><span class="va">cf</span>, <span class="va">healthy</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon signed rank test </span></span>
<span><span class="co">##          obs sum ranks expected</span></span>
<span><span class="co">## positive  10        71     45.5</span></span>
<span><span class="co">## negative   3        20     45.5</span></span>
<span><span class="co">## zero       0         0      0.0</span></span>
<span><span class="co">## all       13        91     91.0</span></span>
<span><span class="co">##                             </span></span>
<span><span class="co">## unadjusted variance   204.75</span></span>
<span><span class="co">## adjustment for ties     0.00</span></span>
<span><span class="co">## adjustment for zeroes   0.00</span></span>
<span><span class="co">## adjusted variance     204.75</span></span>
<span><span class="co">##                     H0 Ha       </span></span>
<span><span class="co">## Hypothesized Median 0  two.sided</span></span>
<span><span class="co">##   Test Statistic p-value </span></span>
<span><span class="co">## Z 1.7821         0.074735</span></span></code></pre>
<p>This function can also provide a confidence interval for the median,
although unlike the Wilcoxon and Mann-Whitney tests, this confidence
interval is semiparametric rather than nonparametric.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wilcoxon.html">wilcoxon</a></span><span class="op">(</span><span class="va">cf</span>, <span class="va">healthy</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon signed rank test </span></span>
<span><span class="co">##          obs sum ranks expected</span></span>
<span><span class="co">## positive  10        71     45.5</span></span>
<span><span class="co">## negative   3        20     45.5</span></span>
<span><span class="co">## zero       0         0      0.0</span></span>
<span><span class="co">## all       13        91     91.0</span></span>
<span><span class="co">##                             </span></span>
<span><span class="co">## unadjusted variance   204.75</span></span>
<span><span class="co">## adjustment for ties     0.00</span></span>
<span><span class="co">## adjustment for zeroes   0.00</span></span>
<span><span class="co">## adjusted variance     204.75</span></span>
<span><span class="co">##                     H0 Ha       </span></span>
<span><span class="co">## Hypothesized Median 0  two.sided</span></span>
<span><span class="co">##   Test Statistic p-value  CI           Point Estimate</span></span>
<span><span class="co">## Z 1.7821         0.074735 [-27, 238.5] 117.5</span></span></code></pre>
<p>Note that there is no version of <code>wilcoxon</code> using summary
statistics, since the test relies on the ranks of the observed data.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Amy D Willis, Taylor Okonek, Charles J Wolock, Brian D Williamson, Scott S Emerson, Andrew J Spieker, Yiqun T Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
