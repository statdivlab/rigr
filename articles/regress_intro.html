<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rigr">
<title>Regression in rigr • rigr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression in rigr">
<meta property="og:description" content="rigr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rigr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/descrip_intro.html">Descriptive statistics in rigr</a>
    <a class="dropdown-item" href="../articles/one_and_two_sample_inference.html">One- and two-sample inference in rigr</a>
    <a class="dropdown-item" href="../articles/regress_intro.html">Regression in rigr</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/statdivlab/rigr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Regression in rigr</h1>
                        <h4 data-toc-skip class="author">Taylor Okonek, Brian D. Williamson and Amy D. Willis</h4>
            
            <h4 data-toc-skip class="date">2022-08-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/statdivlab/rigr/blob/HEAD/vignettes/regress_intro.Rmd" class="external-link"><code>vignettes/regress_intro.Rmd</code></a></small>
      <div class="d-none name"><code>regress_intro.Rmd</code></div>
    </div>

    
    
<p>In the <code>rigr</code> package, we have set out to make regression and analysis easier by</p>
<ol style="list-style-type: decimal">
<li>allowing you to specify different types of regression from one function;</li>
<li>automatically computing confidence intervals and p-values using robust standard errors;</li>
<li>displaying output in a more intuitive fashion than base R; and</li>
<li>allowing you to specify multiple-partial F-tests.</li>
</ol>
<p>This capability is implemented in the function <code><a href="../reference/regress.html">regress()</a></code>. The basic arguments to this function are</p>
<ul>
<li>
<code>fnctl</code>: the functional</li>
<li>
<code>formula</code>: the formula for the linear model</li>
<li>
<code>data</code>: the data to use for the model</li>
</ul>
<div class="section level3">
<h3 id="fnctl-the-functional">
<code>fnctl</code>: the functional<a class="anchor" aria-label="anchor" href="#fnctl-the-functional"></a>
</h3>
<p>We use the concept of a <em>functional</em> to handle our first goal: allowing you to specify different types of regression models using a single function. A functional takes a <em>function</em> as its argument and returns a number. The most common example of a functional in regression is the <em>mean</em>. The allowed functionals to <code><a href="../reference/regress.html">regress()</a></code> are</p>
<table class="table">
<colgroup>
<col width="27%">
<col width="36%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th>Functional</th>
<th align="left">Type of Regression</th>
<th align="left">base R command</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"mean"</code></td>
<td align="left">Linear Regression</td>
<td align="left"><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></td>
</tr>
<tr class="even">
<td><code>"geometric mean"</code></td>
<td align="left">Linear Regression on logarithmically transformed Y</td>
<td align="left">
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, with Y log-transformed</td>
</tr>
<tr class="odd">
<td><code>"odds"</code></td>
<td align="left">Logistic Regression</td>
<td align="left"><code>glm(family = binomial)</code></td>
</tr>
<tr class="even">
<td><code>"rate"</code></td>
<td align="left">Poisson Regression</td>
<td align="left"><code>glm(family = poisson)</code></td>
</tr>
<tr class="odd">
<td><code>"hazard"</code></td>
<td align="left">Proportional Hazards Regression</td>
<td align="left"><code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph()</a></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="formula-and-data">
<code>formula</code> and <code>data</code><a class="anchor" aria-label="anchor" href="#formula-and-data"></a>
</h3>
<p>The <em>formula</em> to <code><a href="../reference/regress.html">regress()</a></code> is the same as a formula given to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> or <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>, but with additional optional functionality to enable sophisticated analyses (multiple partial F-tests) with fewer headaches.</p>
<!-- To allow users to specify multiple partial F-tests, we have added a special function - `U()` - which can be added to the formula. `regress()` will compute an F statistic for all variables included inside the `U()` specification. -->
<p>The <em>data</em> argument is exactly the same as that in <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> or any of the other regression commands.</p>
</div>
<div class="section level2">
<h2 id="linear-regression">Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h2>
<p>As a first example, we run a linear regression of atrophy (a measure of global brain activity) on age, sex and race, from the <code>mri</code> data. This dataset is included in the <code>rigr</code> package; see its documentation by running <code><a href="../reference/mri.html">?mri</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Preparing our R session</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statdivlab.github.io/rigr/">rigr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rigr version 1.0.2: Regression, Inference, and General Data Analysis Tools in R</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mri</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">race</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ age + sex + race, </span></span>
<span><span class="co">##     data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -34.120  -8.331  -0.434   7.325  53.915 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                                          Estimate  Naive SE </span></span>
<span><span class="co">## [1] Intercept                                             -17.60     6.341  </span></span>
<span><span class="co">## [2] age                                                    0.6866   0.08134 </span></span>
<span><span class="co">## [3] sexMale                                                5.988     0.8867 </span></span>
<span><span class="co">##     race                                                                    </span></span>
<span><span class="co">## [4]    Black                                              -2.375     2.109  </span></span>
<span><span class="co">## [5]    Subject did not identify White, Black or Asian     -3.078     3.885  </span></span>
<span><span class="co">## [6]    White                                              -0.2664    1.822  </span></span>
<span><span class="co">##                                                          Robust SE    95%L     </span></span>
<span><span class="co">## [1] Intercept                                              6.893       -31.14  </span></span>
<span><span class="co">## [2] age                                                   0.08836       0.5132 </span></span>
<span><span class="co">## [3] sexMale                                                0.8895       4.242  </span></span>
<span><span class="co">##     race                                                                       </span></span>
<span><span class="co">## [4]    Black                                               2.049       -6.397  </span></span>
<span><span class="co">## [5]    Subject did not identify White, Black or Asian      4.157       -11.24  </span></span>
<span><span class="co">## [6]    White                                               1.780       -3.761  </span></span>
<span><span class="co">##                                                          95%H         F stat   </span></span>
<span><span class="co">## [1] Intercept                                             -4.072           6.52</span></span>
<span><span class="co">## [2] age                                                    0.8601         60.38</span></span>
<span><span class="co">## [3] sexMale                                                7.734          45.32</span></span>
<span><span class="co">##     race                                                                   1.14</span></span>
<span><span class="co">## [4]    Black                                               1.647           1.34</span></span>
<span><span class="co">## [5]    Subject did not identify White, Black or Asian      5.082           0.55</span></span>
<span><span class="co">## [6]    White                                               3.228           0.02</span></span>
<span><span class="co">##                                                          df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept                                            1    0.0109 </span></span>
<span><span class="co">## [2] age                                                  1  &lt; 0.00005</span></span>
<span><span class="co">## [3] sexMale                                              1  &lt; 0.00005</span></span>
<span><span class="co">##     race                                                 3    0.3315 </span></span>
<span><span class="co">## [4]    Black                                             1    0.2467 </span></span>
<span><span class="co">## [5]    Subject did not identify White, Black or Asian    1    0.4592 </span></span>
<span><span class="co">## [6]    White                                             1    0.8810 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 12 on 729 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.1439, Adjusted R-squared:  0.138 </span></span>
<span><span class="co">## F-statistic: 21.32 on 5 and 729 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>Notice that by default robust standard error estimates are returned in addition to the naive estimates. The robust estimates are also used to perform inference. Thus, the confidence intervals, statistics, and p-values use these estimates of the standard error.</p>
<p>F-statistics are also displayed by default, including the multiple partial F-tests for the levels of a multi-level category (such as <code>race</code>) as well as the overall F-test for the variable.</p>
</div>
<div class="section level2">
<h2 id="generalized-linear-regression">Generalized Linear Regression<a class="anchor" aria-label="anchor" href="#generalized-linear-regression"></a>
</h2>
<div class="section level3">
<h3 id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h3>
<p>We can also run generalized linear regression using <code><a href="../reference/regress.html">regress()</a></code>. For example, to model the odds of having diabetes for males compared to females, we could run a logistic regression as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"odds"</span>, <span class="va">diabetes</span> <span class="op">~</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "odds", formula = diabetes ~ sex, data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Deviance Residuals: </span></span>
<span><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">## -0.5593  -0.5593  -0.3823  -0.3823   2.3034  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Raw Model:</span></span>
<span><span class="co">##                  Estimate  Naive SE  Robust SE       F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept     -2.580     0.2034    0.2037           160.39 1  &lt; 0.00005</span></span>
<span><span class="co">## [2] sexMale        0.8037    0.2519    0.2522            10.15 1    0.0015 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformed Model:</span></span>
<span><span class="co">##                  e(Est)    e(95%L)   e(95%H)         F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept     0.07580   0.05082    0.1131           160.39 1  &lt; 0.00005</span></span>
<span><span class="co">## [2] sexMale        2.234     1.361     3.665             10.15 1    0.0015 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 501.59  on 734  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 490.82  on 733  degrees of freedom</span></span>
<span><span class="co">## AIC: 494.82</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 5</span></span></code></pre>
<p>In all of the generalized linear regression output we see two tables. The <code>Raw Model</code> table displays estimated coefficients (and their standard errors) on the log-odds scale. The <code>Transformed Model</code> table exponentiates the estimated coefficients and their confidence intervals so that the estimated parameters can be interpreted on the odds scale.</p>
<p>Note that the only possible link function in <code>regress</code> with <code>fnctl = odds"</code> is the logit link. Similarly, the only possible link function in <code>regress</code> with <code>fnctl = "rate"</code> is the log link.</p>
</div>
<div class="section level3">
<h3 id="poisson-regression">Poisson Regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h3>
<p>The next functional that <code>regress</code> supports is <code>"rate"</code>, for use in Poisson regression. To regress <code>yrsquit</code> on <code>age</code>, we would run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"rate"</span>, <span class="va">yrsquit</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "rate", formula = yrsquit ~ age, data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Deviance Residuals: </span></span>
<span><span class="co">##    Min      1Q  Median      3Q     Max  </span></span>
<span><span class="co">## -5.385  -4.365  -4.186   2.395   9.920  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Raw Model:</span></span>
<span><span class="co">##                  Estimate  Naive SE   Robust SE        F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept      1.011     0.1571     0.7239              1.95 1    0.1629 </span></span>
<span><span class="co">## [2] age           0.01680   2.087e-03  9.688e-03            3.01 1    0.0834 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformed Model:</span></span>
<span><span class="co">##                  e(Est)    e(95%L)   e(95%H)         F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept      2.749     0.6637    11.39              1.95 1    0.1629 </span></span>
<span><span class="co">## [2] age            1.017     0.9978    1.036              3.01 1    0.0834 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for poisson family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 14574  on 734  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 14511  on 733  degrees of freedom</span></span>
<span><span class="co">## AIC: 16008</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 6</span></span></code></pre>
<p>Note that again we have two tables of output, denoted by <code>Raw Model</code> and <code>Transformed Model</code>, with <code>Transformed Model</code> displaying exponentiated estimated coefficients.</p>
</div>
<div class="section level3">
<h3 id="proportional-hazards-regression">Proportional Hazards Regression<a class="anchor" aria-label="anchor" href="#proportional-hazards-regression"></a>
</h3>
<p>The final functional that <code>regress</code> supports is <code>"hazard"</code>, for use in proportional hazards regression. To regress <code>age</code> on the death status (note that we need to create a <code>Surv</code> object first), we would run:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"hazard"</span>, <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">obstime</span>, <span class="va">death</span><span class="op">)</span><span class="op">~</span><span class="va">age</span>, data<span class="op">=</span><span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "hazard", formula = Surv(obstime, death) ~ age, </span></span>
<span><span class="co">##     data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Raw Model:</span></span>
<span><span class="co">##            Estimate  Naive SE  Robust SE       F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] age     0.06795   0.01354   0.01412            23.17 1  &lt; 0.00005</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformed Model:</span></span>
<span><span class="co">##            e(Est)    e(95%L)   e(95%H)         F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] age      1.070     1.041     1.100             23.17 1  &lt; 0.00005</span></span>
<span><span class="co">## n =  735, number of events= 133 </span></span>
<span><span class="co">## Overall significance test: </span></span>
<span><span class="co">## Likelihood ratio test= 22.33  on 1 df,   p=2.292e-06</span></span>
<span><span class="co">## Wald test            = 25.17  on 1 df,   p=5.24e-07</span></span>
<span><span class="co">## Score (logrank) test = 25.44  on 1 df,   p=4.554e-07</span></span></code></pre>
<p>Similar to the Poisson regression case, we have two tables of output, denoted by <code>Raw Model</code> and <code>Transformed Model</code>, with <code>Transformed Model</code> displaying exponentiated estimated coefficients (i.e., on the hazard scale).</p>
</div>
</div>
<div class="section level2">
<h2 id="regression-on-the-geometric-mean">Regression on the Geometric Mean<a class="anchor" aria-label="anchor" href="#regression-on-the-geometric-mean"></a>
</h2>
<p>Most often in linear regression we are interested in modeling the mean of the response variable. However, we are sometimes interested in modeling the mean of the log-transformed response variable, which allows us to make statements about the geometric mean of the response. In <code><a href="../reference/regress.html">regress()</a></code>, we can use the <code>"geometric mean"</code> functional to fit this model. Regression on the geometric mean of the <code>packyrs</code> variable in the <code>mri</code> dataset can be performed as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"geometric mean"</span>, <span class="va">packyrs</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ( 1  cases deleted due to missing values)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "geometric mean", formula = packyrs ~ age, data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -4.136 -3.417  1.283  2.970  5.219 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Raw Model:</span></span>
<span><span class="co">##                  Estimate  Naive SE  Robust SE       F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept      6.410     1.586     1.537             17.39 1  &lt; 0.00005</span></span>
<span><span class="co">## [2] age          -0.07986   0.02121   0.02050            15.17 1     1e-04 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformed Model:</span></span>
<span><span class="co">##                  e(Est)    e(95%L)   e(95%H)         F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept      608.1     29.74     12431             17.39 1  &lt; 0.00005</span></span>
<span><span class="co">## [2] age            0.9232    0.8868    0.9612            15.17 1     1e-04 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 3.13 on 732 degrees of freedom</span></span>
<span><span class="co">##   (1 observation deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.01899,    Adjusted R-squared:  0.01765 </span></span>
<span><span class="co">## F-statistic: 15.17 on 1 and 732 DF,  p-value: 0.0001074</span></span></code></pre>
<p>It should be noted that many of the <code>packyrs</code> observations are zero, but the geometric mean of data including an observation of zero is zero… regardless of how many non-zeros were also observed. Therefore, by default, zeroes in the outcome variable are replaced by a value equal to one-half the lowest nonzero value in the outcome variable. This is based on the idea that the lowest observed value could be a proxy for the lower limit of detection. If you wish to specify a different value with which to replace zeroes, you may do say using the <code>replaceZeroes</code> argument.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"geometric mean"</span>, <span class="va">packyrs</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">mri</span>, replaceZeroes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ( 1  cases deleted due to missing values)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "geometric mean", formula = packyrs ~ age, data = mri, </span></span>
<span><span class="co">##     replaceZeroes = 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.6437 -1.7460  0.0625  1.7259  3.8246 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Raw Model:</span></span>
<span><span class="co">##                  Estimate  Naive SE  Robust SE       F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept      5.119     0.8887    0.8462            36.60 1  &lt; 0.00005</span></span>
<span><span class="co">## [2] age          -0.04498   0.01189   0.01127            15.93 1     1e-04 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Transformed Model:</span></span>
<span><span class="co">##                  e(Est)    e(95%L)   e(95%H)         F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept      167.2     31.76     880.7             36.60 1  &lt; 0.00005</span></span>
<span><span class="co">## [2] age            0.9560    0.9351    0.9774            15.93 1     1e-04 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.754 on 732 degrees of freedom</span></span>
<span><span class="co">##   (1 observation deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.01919,    Adjusted R-squared:  0.01785 </span></span>
<span><span class="co">## F-statistic: 15.93 on 1 and 732 DF,  p-value: 7.218e-05</span></span></code></pre>
<p>In the output from regress using the geometric mean functional, we see a table for the <code>Raw Model</code> and the <code>Transformed Model</code>. The <code>e(Est)</code>, <code>e(95%L)</code>, and <code>e(95%H)</code> columns in the <code>Transformed Model</code> table correspond to exponentiated values from the <code>Raw Model</code> - you’ll notice that <span class="math inline">\(e^{5.119} \approx 167.2.\)</span></p>
</div>
<div class="section level2">
<h2 id="re-parameterizations-of-a-variable">Re-parameterizations of a Variable<a class="anchor" aria-label="anchor" href="#re-parameterizations-of-a-variable"></a>
</h2>
<p>There are two special functions in <code>rigr</code> which allow us to re-parameterize variables:</p>
<ul>
<li>
<code>dummy</code>: create dummy variables</li>
<li>
<code>polynomial</code>: create a polynomial</li>
</ul>
<p>Both of these functions may be used in a <code><a href="../reference/regress.html">regress()</a></code> call, and will additionally give a multiple partial F-test of the entire variable automatically.</p>
<div class="section level3">
<h3 id="specifying-the-reference-group-with-dummy">Specifying the reference group with <code>dummy</code><a class="anchor" aria-label="anchor" href="#specifying-the-reference-group-with-dummy"></a>
</h3>
<p>The <code>dummy</code> function is useful for specifying the reference group that you wish to use with categorical variables. Below we show an example of using the reference group “Female” vs. the reference group “Male” in a regression on <code>sex</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="fu"><a href="../reference/dummy.html">dummy</a></span><span class="op">(</span><span class="va">sex</span>, reference <span class="op">=</span> <span class="st">"Male"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ dummy(sex, reference = "Male"), </span></span>
<span><span class="co">##     data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -29.087  -9.087  -0.905   8.095  49.095 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                         Estimate  Naive SE  Robust SE   </span></span>
<span><span class="co">## [1] Intercept                             39.09     0.6563    0.6733    </span></span>
<span><span class="co">## [2]   dummy(sex, reference = "Male")     -6.182     0.9263    0.9265    </span></span>
<span><span class="co">##                                         95%L      95%H         F stat    df</span></span>
<span><span class="co">## [1] Intercept                             37.77     40.41        3370.22 1 </span></span>
<span><span class="co">## [2]   dummy(sex, reference = "Male")     -8.001    -4.363          44.53 1 </span></span>
<span><span class="co">##                                         Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept                           &lt; 0.00005</span></span>
<span><span class="co">## [2]   dummy(sex, reference = "Male")    &lt; 0.00005</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Dummy terms calculated from sex, reference = Male </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 12.56 on 733 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.05729,    Adjusted R-squared:  0.05601 </span></span>
<span><span class="co">## F-statistic: 44.53 on 1 and 733 DF,  p-value: 4.944e-11</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="fu"><a href="../reference/dummy.html">dummy</a></span><span class="op">(</span><span class="va">sex</span>, reference <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ dummy(sex, reference = "Female"), </span></span>
<span><span class="co">##     data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -29.087  -9.087  -0.905   8.095  49.095 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                           Estimate  Naive SE  Robust SE   </span></span>
<span><span class="co">## [1] Intercept                               32.91     0.6536    0.6364    </span></span>
<span><span class="co">## [2]   dummy(sex, reference = "Female")      6.182     0.9263    0.9265    </span></span>
<span><span class="co">##                                           95%L      95%H         F stat    df</span></span>
<span><span class="co">## [1] Intercept                               31.66     34.15        2673.43 1 </span></span>
<span><span class="co">## [2]   dummy(sex, reference = "Female")      4.363     8.001          44.53 1 </span></span>
<span><span class="co">##                                           Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept                             &lt; 0.00005</span></span>
<span><span class="co">## [2]   dummy(sex, reference = "Female")    &lt; 0.00005</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Dummy terms calculated from sex, reference = Female </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 12.56 on 733 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.05729,    Adjusted R-squared:  0.05601 </span></span>
<span><span class="co">## F-statistic: 44.53 on 1 and 733 DF,  p-value: 4.944e-11</span></span></code></pre>
<p>Notice that below the coefficients table in the output, the reference category is reported.</p>
</div>
<div class="section level3">
<h3 id="polynomial-regression">Polynomial regression<a class="anchor" aria-label="anchor" href="#polynomial-regression"></a>
</h3>
<p>You can fit higher-order polynomials using <code>polynomial</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="fu"><a href="../reference/polynomial.html">polynomial</a></span><span class="op">(</span><span class="va">age</span>, degree <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ polynomial(age, degree = 2), </span></span>
<span><span class="co">##     data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -36.828  -9.063  -1.018   7.816  50.887 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                    Estimate  Naive SE  Robust SE    95%L      </span></span>
<span><span class="co">## [1] Intercept                        35.34     0.5598    0.5622        34.24  </span></span>
<span><span class="co">##     polynomial(age, degree = 2)                                               </span></span>
<span><span class="co">## [2]    age^1                         0.5869    0.1009   0.09808       0.3943  </span></span>
<span><span class="co">## [3]    age^2                        0.02159   0.01099   0.01150     -9.897e-04</span></span>
<span><span class="co">##                                    95%H         F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept                        36.45        3952.13 1  &lt; 0.00005</span></span>
<span><span class="co">##     polynomial(age, degree = 2)                     32.91 2  &lt; 0.00005</span></span>
<span><span class="co">## [2]    age^1                         0.7794         35.80 1  &lt; 0.00005</span></span>
<span><span class="co">## [3]    age^2                        0.04417          3.52 1    0.0609 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Polynomial terms calculated from age, centered at 74.566 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 12.33 on 732 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.09148,    Adjusted R-squared:  0.089 </span></span>
<span><span class="co">## F-statistic: 32.91 on 2 and 732 DF,  p-value: 2.06e-14</span></span></code></pre>
<p>Note that all polynomials less than or equal to the degree specified are included in the model, and that the variables in the polynomial specification are mean-centered by default. You can change the centering using the <code>center</code> parameter in the polynomial function, an example of which is as follows.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="fu"><a href="../reference/polynomial.html">polynomial</a></span><span class="op">(</span><span class="va">age</span>, degree <span class="op">=</span> <span class="fl">2</span>, center <span class="op">=</span> <span class="fl">65</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ polynomial(age, degree = 2, </span></span>
<span><span class="co">##     center = 65), data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -36.828  -9.063  -1.018   7.816  50.887 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                                 Estimate  Naive SE </span></span>
<span><span class="co">## [1] Intercept                                     31.70     1.528  </span></span>
<span><span class="co">##     polynomial(age, degree = 2, center = 65)                       </span></span>
<span><span class="co">## [2]    age^1                                      0.1738    0.2797 </span></span>
<span><span class="co">## [3]    age^2                                     0.02159   0.01099 </span></span>
<span><span class="co">##                                                 Robust SE    95%L      </span></span>
<span><span class="co">## [1] Intercept                                     1.497         28.77  </span></span>
<span><span class="co">##     polynomial(age, degree = 2, center = 65)                           </span></span>
<span><span class="co">## [2]    age^1                                      0.2811      -0.3781  </span></span>
<span><span class="co">## [3]    age^2                                     0.01150     -9.897e-04</span></span>
<span><span class="co">##                                                 95%H         F stat    df</span></span>
<span><span class="co">## [1] Intercept                                     34.64         448.45 1 </span></span>
<span><span class="co">##     polynomial(age, degree = 2, center = 65)                     32.91 2 </span></span>
<span><span class="co">## [2]    age^1                                      0.7257          0.38 1 </span></span>
<span><span class="co">## [3]    age^2                                     0.04417          3.52 1 </span></span>
<span><span class="co">##                                                 Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept                                   &lt; 0.00005</span></span>
<span><span class="co">##     polynomial(age, degree = 2, center = 65)    &lt; 0.00005</span></span>
<span><span class="co">## [2]    age^1                                      0.5367 </span></span>
<span><span class="co">## [3]    age^2                                      0.0609 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Polynomial terms calculated from age, centered at 65 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 12.33 on 732 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.09148,    Adjusted R-squared:  0.089 </span></span>
<span><span class="co">## F-statistic: 32.91 on 2 and 732 DF,  p-value: 2.06e-14</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="user-specified-multiple-partial-f-tests">User-specified multiple partial F-tests<a class="anchor" aria-label="anchor" href="#user-specified-multiple-partial-f-tests"></a>
</h2>
<p>You can also perform multiple partial F-tests using formulas and the <code>U</code> function. This is useful when want to test a subset of variables all at once in your regression. For example, to test whether both the variables <code>packyrs</code> and <code>yrsquit</code> are associated with <code>atrophy</code> in a model with age as a predictor, we can run</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="fu"><a href="../reference/U.html">U</a></span><span class="op">(</span><span class="st">"Smoking variables"</span> <span class="op">=</span> <span class="op">~</span><span class="va">packyrs</span> <span class="op">+</span> <span class="va">yrsquit</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ( 1  cases deleted due to missing values)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ age + sex + U(`Smoking variables` = ~packyrs + </span></span>
<span><span class="co">##     yrsquit), data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -33.593  -8.613  -0.306   7.279  52.399 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                          Estimate   Naive SE  Robust SE    95%L      95%H     </span></span>
<span><span class="co">## [1] Intercept              -18.82     6.167     6.690       -31.95    -5.683  </span></span>
<span><span class="co">## [2] age                    0.6917    0.08212   0.08900       0.5170    0.8664 </span></span>
<span><span class="co">## [3] sexMale                 5.628     0.9386    0.9596       3.744     7.512  </span></span>
<span><span class="co">##     Smoking variables                                                         </span></span>
<span><span class="co">## [4]   packyrs             9.782e-03  0.01684   0.01693     -0.02346   0.04302 </span></span>
<span><span class="co">## [5]   yrsquit              0.02071   0.03282   0.03276     -0.04361   0.08503 </span></span>
<span><span class="co">##                             F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept                    7.91 1    0.0050 </span></span>
<span><span class="co">## [2] age                         60.40 1  &lt; 0.00005</span></span>
<span><span class="co">## [3] sexMale                     34.39 1  &lt; 0.00005</span></span>
<span><span class="co">##     Smoking variables            0.37 2    0.6905 </span></span>
<span><span class="co">## [4]   packyrs                    0.33 1    0.5636 </span></span>
<span><span class="co">## [5]   yrsquit                    0.40 1    0.5275 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 11.99 on 729 degrees of freedom</span></span>
<span><span class="co">##   (1 observation deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.1419, Adjusted R-squared:  0.1372 </span></span>
<span><span class="co">## F-statistic: 26.44 on 4 and 729 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p><code>"Smoking variables"</code> is what we name the group of variables <code>packyrs</code> and <code>yrsquit</code>. The overall F statistic and p-value associated with the inclusion of these two smoking variables variables in the model are 4.37 and 0.0130, respectively.</p>
</div>
<div class="section level2">
<h2 id="testing-contrasts-hypotheses-about-linear-combinations-of-regression-coefficients">Testing contrasts: hypotheses about linear combinations of regression coefficients<a class="anchor" aria-label="anchor" href="#testing-contrasts-hypotheses-about-linear-combinations-of-regression-coefficients"></a>
</h2>
<p>You may be interested in testing a null hypothesis about a linear combination of coefficients in our regression model. For example, to investigate “Is the mean atrophy for a female subject equal to the mean atrophy for a male subject who is 10 years younger?”, our hypothesis test involves both the coefficients on age and sex. We can test this hypothesis using the <code>lincom</code> function. First, we need to fit a linear model of age and sex on atrophy:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_rigr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/regress.html">regress</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">atrophy</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">mri</span><span class="op">)</span></span>
<span><span class="va">mod_rigr</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## regress(fnctl = "mean", formula = atrophy ~ age + sex, data = mri)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -33.765  -8.582  -0.356   7.344  52.100 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                  Estimate  Naive SE  Robust SE    95%L      95%H     </span></span>
<span><span class="co">## [1] Intercept     -17.83     6.081     6.557       -30.70    -4.959  </span></span>
<span><span class="co">## [2] age            0.6819   0.08129   0.08769       0.5097    0.8540 </span></span>
<span><span class="co">## [3] sexMale        5.964     0.8857    0.8845       4.227     7.700  </span></span>
<span><span class="co">##                     F stat    df Pr(&gt;F)   </span></span>
<span><span class="co">## [1] Intercept            7.40 1    0.0067 </span></span>
<span><span class="co">## [2] age                 60.47 1  &lt; 0.00005</span></span>
<span><span class="co">## [3] sexMale             45.46 1  &lt; 0.00005</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 12 on 732 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:   0.14,  Adjusted R-squared:  0.1376 </span></span>
<span><span class="co">## F-statistic: 52.18 on 2 and 732 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>We then create a vector giving the linear combination of the coefficient that we hypothesized to be zero, and perform the test using <code>lincom</code>. The elements in <code>mod_combo</code> correspond to <code>Intercept</code>, <code>age</code>, and <code>sexMale</code>, because this was their order in the coefficient table shown above.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_combo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/lincom.html">lincom</a></span><span class="op">(</span><span class="va">mod_rigr</span>, <span class="va">mod_combo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## H0: -10*age+1*sexMale   =  0 </span></span>
<span><span class="co">## Ha: -10*age+1*sexMale  !=  0 </span></span>
<span><span class="co">##      Estimate Std. Err.   95%L   95%H      T Pr(T &gt; |t|)</span></span>
<span><span class="co">## [1,]   -0.855     1.236 -3.282  1.571 -0.692       0.489</span></span></code></pre>
<p>Note that the standard errors returned by default are robust, as are the associated confidence intervals and p-values.</p>
<p>We could also test the null hypothesis that the mean difference in atrophy between these two groups (females, and males 10 years younger) is equal to -1 as follows:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lincom.html">lincom</a></span><span class="op">(</span><span class="va">mod_rigr</span>, <span class="va">mod_combo</span>, null.hypoth <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## H0: -10*age+1*sexMale   =  -1 </span></span>
<span><span class="co">## Ha: -10*age+1*sexMale  !=  -1 </span></span>
<span><span class="co">##      Estimate Std. Err.   95%L   95%H     T Pr(T &gt; |t|)</span></span>
<span><span class="co">## [1,]   -0.855     1.236 -3.282  1.571 0.117       0.907</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Amy D Willis, Taylor Okonek, Charles J Wolock, Brian D Williamson, Scott S Emerson, Andrew J Spieker, Yiqun T Chen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
